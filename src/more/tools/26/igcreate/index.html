<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Story Creator</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
			background: #000;
			display: flex;
			justify-content: center;
			align-items: center;
			min-height: 100vh;
			padding: 20px;
		}

		main {
			display: flex;
			gap: 20px;
			max-width: 1200px;
			width: 100%;
		}
		h4 {
			margin-bottom: 10px;
			font-weight: unset;
		}

		.canvas-wrapper {
			position: relative;
		}

		.story-canvas {
			width: 375px;
			height: 667px;
			border-radius: 20px;
			box-shadow: 0 20px 60px rgba(0,0,0,0.5);
			cursor: move;
			display: block;
		}

		#control-area {
			flex: 1;
			padding: 30px;
			color: white;
			display: flex;
			gap: 10px;
		}
		.row {
			display: flex;
			flex-direction: column;
			gap: 10px;
		}
		.control-group {
			background-color: #242424;
			padding: 10px;
			border-radius: 5px;
		}
		textarea {
			width: 100%;
			padding: 12px;
			background: #2a2a2a;
			border: 1px solid #3a3a3a;
			border-radius: 10px;
			color: white;
			font-size: 16px;
			font-family: inherit;
			resize: vertical;
			min-height: 80px;
		}

		textarea:focus {
			outline: none;
			border-color: #667eea;
		}

		.gradient-grid {
			display: grid;
			grid-template-columns: repeat(6, 1fr);
			gap: 10px;
		}

		.gradient-option {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			cursor: pointer;
			transition: all 0.3s;
		}

		.gradient-option:hover {
			transform: scale(1.05);
		}

		.gradient-option.active {
			border: 3px solid white;
		}

		.upload-option {
			background: #2a2a2a;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 24px;
			color: #667eea;
			position: relative;
			overflow: hidden;
		}

		.upload-option input[type="file"] {
			position: absolute;
			width: 100%;
			height: 100%;
			opacity: 0;
			cursor: pointer;
		}

		.font-grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 10px;
		}

		.font-option {
			width: 100%;
			height: 60px;
			border-radius: 10px;
			border: 3px solid transparent;
			cursor: pointer;
			transition: all 0.3s;
			background: #2a2a2a;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 20px;
			color: white;
		}

		.font-option:hover {
			transform: scale(1.05);
			background: #3a3a3a;
		}

		.font-option.active {
			border-color: white;
			box-shadow: 0 0 20px rgba(255,255,255,0.3);
		}

		.font-size-control {
			display: flex;
			align-items: center;
			gap: 15px;
		}

		input[type="range"] {
			flex: 1;
			height: 6px;
			background: #3a3a3a;
			border-radius: 5px;
			outline: none;
			-webkit-appearance: none;
		}

		input[type="range"]::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 20px;
			height: 20px;
			background: #667eea;
			cursor: pointer;
			border-radius: 50%;
		}

		input[type="range"]::-moz-range-thumb {
			width: 20px;
			height: 20px;
			background: #667eea;
			cursor: pointer;
			border-radius: 50%;
			border: none;
		}

		.size-value {
			min-width: 40px;
			text-align: right;
			font-weight: 600;
		}

		.color-picker-group {
			display: flex;
			gap: 10px;
			align-items: center;
		}

		input[type="color"] {
			width: 50px;
			height: 50px;
			border: none;
			border-radius: 10px;
			cursor: pointer;
			background: transparent;
		}

		input[type="color"]::-webkit-color-swatch-wrapper {
			padding: 0;
		}

		input[type="color"]::-webkit-color-swatch {
			border: 3px solid #3a3a3a;
			border-radius: 10px;
		}

		.download-btn {
			width: 100%;
			padding: 15px;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			border: none;
			border-radius: 10px;
			color: white;
			font-size: 16px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s;
		}

		.download-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
		}

		.download-btn:active {
			transform: translateY(0);
		}

		@media (max-width: 900px) {
			main {
				flex-direction: column;
				align-items: center;
			}
			
			#control-area {
				max-width: 375px;
			}
		}
	</style>
</head>
<body>
	<main>
		<div class="canvas-wrapper">
			<canvas id="canvas" class="story-canvas" width="375" height="667"></canvas>
		</div>
		<div id="control-area">
			<div id="header"></div>
			<div id="controls">
				<div class="row">
					<div class="control-group">
						<h3>Text</h3>
						<textarea id="textInput" placeholder="Enter your text...">Tap to edit text</textarea>
					</div>
					<div class="control-group">
						<h3>Background</h3>
						<h4>Modern (Type 2018)</h4>
						<div class="gradient-grid">
							<div class="gradient-option" style="background: linear-gradient(45deg, #f88140 0%, #a828b3 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #34baf1 0%, #9c2fbc 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #d7ac4e 0%, #ee4957 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #60a344 0%, #28c4f4 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #b3075b 0%, #e84fff 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #2f81cd 0%, #28c4f5 100%);"></div>
						</div>
						<h4>Neon (Type 2018)</h4>
						<div class="gradient-grid">
							<div class="gradient-option" style="background: linear-gradient(45deg, #24002a 0%, #7e0091 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #d981ab 0%, #b00053 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #0389b2 0%, #00274c 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #202020 0%, #363636 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #7d010c 0%, #000000 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #195000 0%, #000000 100%);"></div>
						</div>
						<h4>Typewriter (Type 2018)</h4>
						<div class="gradient-grid">
							<div class="gradient-option" style="background: linear-gradient(45deg, #939393 0%, #eeeeee 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #202020 0%, #737172 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #d3c973 0%, #fef8e3 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #b9a282 0%, #b9b09f 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #400008 0%, #6e0006 100%);"></div>
						</div>
						<h4>Strong (Type 2018)</h4>
						<div class="gradient-grid">
							<div class="gradient-option" style="background: linear-gradient(45deg, #ca3e49 0%, #0f0e0c 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #6ebfda 0%, #28c4f5 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #a9a9a9 0%, #fafafa 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(45deg, #000000 0%, #262626 100%);"></div>
						</div>
						<h4>Create (2019)</h4>
						<div class="gradient-grid">
							<div class="gradient-option" style="background: linear-gradient(135deg, #cb31e2 0%, #fc8d33 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(135deg, #c731e3 0%, #5fb0ff 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(135deg, #6dc056 0%, #28c4f4 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(135deg, #ea4a59 0%, #fdca5c 100%);"></div>
							<div class="gradient-option" style="background: linear-gradient(135deg, #cb2fe3 0%, #fe6876 100%);"></div>
							<!-- this one should be rainbow -->
							<div class="gradient-option" style="background: linear-gradient(135deg, #cb31e2 0%, #fc8d33 100%);"></div>
							<div class="gradient-option" style="background: #262626;"></div>
							<div class="gradient-option" style="background: #dbdbdb;"></div>
						</div>
					</div>
					<div class="gradient-option upload-option">ðŸ“·<input type="file" id="imageUpload" accept="image/*"></div>
				</div>

				<div class="control-group">
					<label>Font Style</label>
					<div class="font-grid" id="fontGrid"></div>
				</div>

				<div class="control-group">
					<label>Font Size</label>
					<div class="font-size-control">
						<input type="range" id="fontSize" min="16" max="72" value="32">
						<span class="size-value" id="fontSizeValue">32px</span>
					</div>
				</div>

				<div class="control-group">
					<label>Text Color</label>
					<div class="color-picker-group">
						<input type="color" id="textColor" value="#ffffff">
					</div>
				</div>

				<div class="control-group">
					<button class="download-btn" id="downloadBtn">ðŸ“¥ Download Story</button>
				</div>
			</div>
		</div>
	</main>

	<script>
		const gradients = [
			{ name: 'purple', colors: ['#667eea', '#764ba2'] },
			{ name: 'pink', colors: ['#f093fb', '#f5576c'] },
			{ name: 'blue', colors: ['#4facfe', '#00f2fe'] },
			{ name: 'green', colors: ['#43e97b', '#38f9d7'] },
			{ name: 'sunset', colors: ['#fa709a', '#fee140'] },
			{ name: 'ocean', colors: ['#30cfd0', '#330867'] },
			{ name: 'pastel', colors: ['#a8edea', '#fed6e3'] },
			{ name: 'orange', colors: ['#ff9a56', '#ff6a88'] },
			{ name: 'peach', colors: ['#ffecd2', '#fcb69f'] },
			{ name: 'rose', colors: ['#ff6e7f', '#bfe9ff'] },
			{ name: 'lavender', colors: ['#e0c3fc', '#8ec5fc'] },
			{ name: 'coral', colors: ['#f77062', '#fe5196'] }
		];

		const fonts = [
			{ name: 'Classic', family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif' },
			{ name: 'Serif', family: 'Georgia, "Times New Roman", serif' },
			{ name: 'Mono', family: '"Courier New", Courier, monospace' },
			{ name: 'Casual', family: 'Comic Sans MS, cursive' },
			{ name: 'Impact', family: 'Impact, fantasy' },
			{ name: 'Modern', family: 'Arial, Helvetica, sans-serif' }
		];

		const canvas = document.getElementById('canvas');
		const ctx = canvas.getContext('2d');
		const textInput = document.getElementById('textInput');
		const gradientGrid = document.getElementById('gradientGrid');
		const fontGrid = document.getElementById('fontGrid');
		const fontSize = document.getElementById('fontSize');
		const fontSizeValue = document.getElementById('fontSizeValue');
		const textColor = document.getElementById('textColor');
		const downloadBtn = document.getElementById('downloadBtn');

		let currentText = 'Tap to edit text';
		let currentFontSize = 32;
		let currentFont = fonts[0].family;
		let currentColor = '#ffffff';
		let currentBackground = null;
		let backgroundImage = null;
		let textX = canvas.width / 2;
		let textY = canvas.height / 2;
		let isDragging = false;
		let dragOffsetX = 0;
		let dragOffsetY = 0;

		// Draw initial canvas
		function drawCanvas() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);

			// Draw background
			if (backgroundImage) {
				const scale = Math.max(canvas.width / backgroundImage.width, canvas.height / backgroundImage.height);
				const x = (canvas.width / 2) - (backgroundImage.width / 2) * scale;
				const y = (canvas.height / 2) - (backgroundImage.height / 2) * scale;
				ctx.drawImage(backgroundImage, x, y, backgroundImage.width * scale, backgroundImage.height * scale);
			} else if (currentBackground) {
				const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
				gradient.addColorStop(0, currentBackground.colors[0]);
				gradient.addColorStop(1, currentBackground.colors[1]);
				ctx.fillStyle = gradient;
				ctx.fillRect(0, 0, canvas.width, canvas.height);
			}

			// Draw text with shadow
			ctx.save();
			ctx.font = `bold ${currentFontSize}px ${currentFont}`;
			ctx.fillStyle = currentColor;
			ctx.textAlign = 'center';
			ctx.textBaseline = 'middle';
			
			// Add text shadow
			ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
			ctx.shadowBlur = 8;
			ctx.shadowOffsetX = 0;
			ctx.shadowOffsetY = 2;

			// Word wrap
			const maxWidth = canvas.width * 0.9;
			const words = currentText.split(' ');
			const lines = [];
			let currentLine = words[0];

			for (let i = 1; i < words.length; i++) {
				const testLine = currentLine + ' ' + words[i];
				const metrics = ctx.measureText(testLine);
				if (metrics.width > maxWidth) {
					lines.push(currentLine);
					currentLine = words[i];
				} else {
					currentLine = testLine;
				}
			}
			lines.push(currentLine);

			const lineHeight = currentFontSize * 1.2;
			const totalHeight = lines.length * lineHeight;
			const startY = textY - (totalHeight / 2) + (lineHeight / 2);

			lines.forEach((line, i) => {
				ctx.fillText(line, textX, startY + (i * lineHeight));
			});

			ctx.restore();
		}

		// Initialize with first gradient
		currentBackground = gradients[0];
		drawCanvas();

		// Create gradient options
		gradients.forEach((gradient, index) => {
			const div = document.createElement('div');
			div.className = 'gradient-option';
			if (index === 0) div.classList.add('active');
			div.style.background = `linear-gradient(135deg, ${gradient.colors[0]} 0%, ${gradient.colors[1]} 100%)`;
			div.addEventListener('click', () => {
				currentBackground = gradient;
				backgroundImage = null;
				document.querySelectorAll('.gradient-option').forEach(el => el.classList.remove('active'));
				div.classList.add('active');
				drawCanvas();
			});
			gradientGrid.appendChild(div);
		});

		// Create upload option
		const uploadDiv = document.createElement('div');
		uploadDiv.className = 'gradient-option upload-option';
		uploadDiv.innerHTML = 'ðŸ“·<input type="file" id="imageUpload" accept="image/*">';
		gradientGrid.appendChild(uploadDiv);

		// Handle image upload
		document.getElementById('imageUpload').addEventListener('change', (e) => {
			const file = e.target.files[0];
			if (file) {
				const reader = new FileReader();
				reader.onload = (event) => {
					const img = new Image();
					img.onload = () => {
						backgroundImage = img;
						currentBackground = null;
						document.querySelectorAll('.gradient-option').forEach(el => el.classList.remove('active'));
						uploadDiv.classList.add('active');
						drawCanvas();
					};
					img.src = event.target.result;
				};
				reader.readAsDataURL(file);
			}
		});

		// Create font options
		fonts.forEach((font, index) => {
			const div = document.createElement('div');
			div.className = 'font-option';
			if (index === 0) div.classList.add('active');
			div.textContent = font.name;
			div.style.fontFamily = font.family;
			div.addEventListener('click', () => {
				currentFont = font.family;
				document.querySelectorAll('.font-option').forEach(el => el.classList.remove('active'));
				div.classList.add('active');
				drawCanvas();
			});
			fontGrid.appendChild(div);
		});

		// Text input
		textInput.addEventListener('input', (e) => {
			currentText = e.target.value || 'Tap to edit text';
			drawCanvas();
		});

		// Font size
		fontSize.addEventListener('input', (e) => {
			currentFontSize = parseInt(e.target.value);
			fontSizeValue.textContent = currentFontSize + 'px';
			drawCanvas();
		});

		// Text color
		textColor.addEventListener('input', (e) => {
			currentColor = e.target.value;
			drawCanvas();
		});

		// Mouse drag functionality
		canvas.addEventListener('mousedown', (e) => {
			const rect = canvas.getBoundingClientRect();
			const x = e.clientX - rect.left;
			const y = e.clientY - rect.top;
			
			dragOffsetX = x - textX;
			dragOffsetY = y - textY;
			isDragging = true;
		});

		canvas.addEventListener('mousemove', (e) => {
			if (isDragging) {
				const rect = canvas.getBoundingClientRect();
				textX = e.clientX - rect.left - dragOffsetX;
				textY = e.clientY - rect.top - dragOffsetY;
				drawCanvas();
			}
		});

		canvas.addEventListener('mouseup', () => {
			isDragging = false;
		});

		canvas.addEventListener('mouseleave', () => {
			isDragging = false;
		});

		// Touch drag functionality
		canvas.addEventListener('touchstart', (e) => {
			e.preventDefault();
			const rect = canvas.getBoundingClientRect();
			const touch = e.touches[0];
			const x = touch.clientX - rect.left;
			const y = touch.clientY - rect.top;
			
			dragOffsetX = x - textX;
			dragOffsetY = y - textY;
			isDragging = true;
		});

		canvas.addEventListener('touchmove', (e) => {
			e.preventDefault();
			if (isDragging) {
				const rect = canvas.getBoundingClientRect();
				const touch = e.touches[0];
				textX = touch.clientX - rect.left - dragOffsetX;
				textY = touch.clientY - rect.top - dragOffsetY;
				drawCanvas();
			}
		});

		canvas.addEventListener('touchend', () => {
			isDragging = false;
		});

		// Download functionality
		downloadBtn.addEventListener('click', () => {
			const link = document.createElement('a');
			link.download = 'instagram-story.png';
			link.href = canvas.toDataURL('image/png');
			link.click();
		});
	</script>
</body>
</html>